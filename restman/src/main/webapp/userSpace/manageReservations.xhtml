<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
   xmlns:ui="http://java.sun.com/jsf/facelets"
   xmlns:f="http://java.sun.com/jsf/core"
   xmlns:h="http://java.sun.com/jsf/html"
   template="../templates/UserTemplate.xhtml">
   
   <ui:define name="top">
   		<h1>Personal reservations</h1>
   </ui:define>
   <ui:define name="content">
      <h1>Reservation management</h1>

      <h:form rendered="#{not empty userReservations}"
			styleClass="simpletablestyle">
			<h:dataTable var="_reservation" value="#{userReservations}">
				<h:column>
					<f:facet name="header">Restaurant</f:facet>
                #{_reservation.restaurant.name}
         		</h:column>
         		<h:column>
					<f:facet name="header">Date</f:facet>
                #{_reservation.time}
         		</h:column>
				<!-- <h:column>
					<f:facet name="header">Menu</f:facet>
                #{_reservation.reservedMenu}
         		</h:column>  -->
				<h:column>
					<f:facet name="header">Table</f:facet>
                #{_reservation.tableNumber}
         		</h:column>
				<h:column>
					<f:facet name="header">Seats</f:facet>
                #{_reservation.seats}
         		</h:column>
				<h:column>
					<h:commandButton value="Edit"
						action="#{reservationController.editReservation(_reservation)}" />
				</h:column>
				<h:column>
					<h:commandButton value="Delete"
						action="#{reservationController.deleteReservation(_reservation)}" />
				</h:column>
			</h:dataTable>
		</h:form>
		<h:form id="test">
			<h2>
				<h:panelGrid rendered="#{!reservationController.edit}">Add reservation</h:panelGrid>
				<h:panelGrid rendered="#{reservationController.edit}">Edit reservation</h:panelGrid>
			</h2>
			<h2></h2>
			<h:messages />
			<h:panelGrid columns="2">
				<h:outputLabel for="restaurant" value="Restaurant:" rendered="#{!reservationController.edit}"/>
				<h:selectOneMenu id="restaurant" value="#{newReservation.restaurant}" 
					converter="#{restaurantConverter}" rendered="#{!reservationController.edit}" >					
					<f:selectItems value="#{restaurantController.allRestaurants}" 
					var="_restaurant" itemValue="#{_restaurant}" itemLabel="#{_restaurant.name}" />
				</h:selectOneMenu>
				<h:outputLabel for="date" value="Date:"/>
		        <h:inputText id="date" value="#{newReservation.time}">
		        	<f:convertDateTime type="date" pattern="dd.MM.yyyy" />
		        </h:inputText>
		        <h:outputLabel for="table" value="Table number:"/>
		        <h:inputText id="table" value="#{newReservation.tableNumber}" />
		        <h:outputLabel for="seats" value="Seats:"/>
		        <h:inputText id="seats" value="#{newReservation.seats}" />
            </h:panelGrid>
            <!-- 
            TODO:
            
            <h:outputLabel for="menu" value="Menu:"/>
		    <h:inputText id="menu" value="#{reservation.reservedMenu}" />
		     -->
		    <h:commandButton rendered="#{!reservationController.edit}" type="submit" immediate="true"
				action="#{reservationController.registerReservation(loggedUser)}" 
				value="Register" />
			<h:commandButton rendered="#{reservationController.edit}" immediate="true" type="submit"
				action="#{reservationController.save}" value="Save" />
			<h:commandButton action="#{reservationController.clear}" value="Clear" />
           
		</h:form>
		<h:panelGroup rendered="#{empty userReservations}">
			<p>No reservations found!</p>
		</h:panelGroup>
   </ui:define>
</ui:composition>
